<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Flappy Bird</title>
    <style>
        body {
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: #000;
        }

        canvas {
            border: 1px solid #fff;
        }
    </style>
</head>

<body>
    <canvas id="gameCanvas" width="400" height="600"></canvas>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // Game variables
        let bird = { x: 50, y: 300, size: 35, velocity: 0, gravity: 0.5, jump: -8 }; // Adjusted size for detailed SVG
        let pipes = [];
        let ground = { y: 550, height: 50, x: 0, speed: 2 };
        let score = 0;
        let gameOver = true; // Start with game over (showing start screen)
        let frame = 0;
        let pipeSpeed = 2;
        let pipeGap = 150; // Gap between top and bottom pipe
        let pipeWidth = 50;
        let pipeInterval = 150; // Frames between new pipes

        // More detailed SVG for bird (wing up state)
        const birdSVGUp = `
<svg width="100" height="100" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
    <!-- Body with gradient -->
    <defs>
        <linearGradient id="bodyGrad" x1="0" y1="0" x2="0" y2="1">
            <stop offset="0%" stop-color="#ffd700"/>
            <stop offset="100%" stop-color="#ffcc00"/>
        </linearGradient>
    </defs>
    <ellipse cx="50" cy="55" rx="35" ry="30" fill="url(#bodyGrad)" stroke="#b8860b" stroke-width="2"/>
    <!-- Tail -->
    <path d="M10 55 Q0 50 10 45 Q20 50 10 55" fill="#ffcc00" stroke="#b8860b" stroke-width="2"/>
    <!-- Wing up (detailed with feathers) -->
    <path d="M30 55 Q10 25 30 35 Q50 15 70 35 Q85 20 70 55 Q50 60 30 55" fill="#ffd700" stroke="#b8860b" stroke-width="2"/>
    <path d="M40 50 L50 30 M50 50 L60 30 M60 50 L70 30" stroke="#b8860b" stroke-width="2"/>
    <!-- Eye -->
    <circle cx="70" cy="45" r="10" fill="#fff" stroke="#000" stroke-width="2"/>
    <circle cx="72" cy="43" r="4" fill="#000"/>
    <circle cx="74" cy="41" r="2" fill="#fff"/>
    <!-- Beak -->
    <path d="M80 48 L95 50 L80 52" fill="#ff4500" stroke="#cd3300" stroke-width="2"/>
    <path d="M80 52 L92 55 L80 56" fill="#ff4500" stroke="#cd3300" stroke-width="2"/>
    <!-- Feet -->
    <path d="M45 80 L40 90 M50 80 L50 90 M55 80 L60 90" stroke="#ff4500" stroke-width="3" stroke-linecap="round"/>
</svg>`;

        // More detailed SVG for bird (wing down state)
        const birdSVGDown = `
<svg width="100" height="100" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
    <!-- Body with gradient -->
    <defs>
        <linearGradient id="bodyGrad" x1="0" y1="0" x2="0" y2="1">
            <stop offset="0%" stop-color="#ffd700"/>
            <stop offset="100%" stop-color="#ffcc00"/>
        </linearGradient>
    </defs>
    <ellipse cx="50" cy="55" rx="35" ry="30" fill="url(#bodyGrad)" stroke="#b8860b" stroke-width="2"/>
    <!-- Tail -->
    <path d="M10 55 Q0 50 10 45 Q20 50 10 55" fill="#ffcc00" stroke="#b8860b" stroke-width="2"/>
    <!-- Wing down (detailed with feathers) -->
    <path d="M30 55 Q10 85 30 75 Q50 95 70 75 Q85 90 70 55 Q50 50 30 55" fill="#ffd700" stroke="#b8860b" stroke-width="2"/>
    <path d="M40 60 L50 80 M50 60 L60 80 M60 60 L70 80" stroke="#b8860b" stroke-width="2"/>
    <!-- Eye -->
    <circle cx="70" cy="45" r="10" fill="#fff" stroke="#000" stroke-width="2"/>
    <circle cx="72" cy="43" r="4" fill="#000"/>
    <circle cx="74" cy="41" r="2" fill="#fff"/>
    <!-- Beak -->
    <path d="M80 48 L95 50 L80 52" fill="#ff4500" stroke="#cd3300" stroke-width="2"/>
    <path d="M80 52 L92 55 L80 56" fill="#ff4500" stroke="#cd3300" stroke-width="2"/>
    <!-- Feet -->
    <path d="M45 80 L40 90 M50 80 L50 90 M55 80 L60 90" stroke="#ff4500" stroke-width="3" stroke-linecap="round"/>
</svg>`;

        // Create Image objects from SVG data URLs
        const birdImageUp = new Image();
        birdImageUp.src = 'data:image/svg+xml;base64,' + btoa(birdSVGUp);

        const birdImageDown = new Image();
        birdImageDown.src = 'data:image/svg+xml;base64,' + btoa(birdSVGDown);

        // Handle input
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') jump();
        });
        canvas.addEventListener('click', jump);

        function jump() {
            if (gameOver) {
                resetGame();
            } else {
                bird.velocity = bird.jump;
            }
        }

        function resetGame() {
            bird.y = 300;
            bird.velocity = 0;
            pipes = [];
            score = 0;
            gameOver = false;
            frame = 0;
        }

        function generatePipe() {
            const topHeight = Math.floor(Math.random() * (canvas.height - ground.height - pipeGap - 100)) + 50;
            const bottomHeight = canvas.height - ground.height - topHeight - pipeGap;
            pipes.push({ x: canvas.width, top: topHeight, bottom: bottomHeight, passed: false });
        }

        function update() {
            if (gameOver) return;

            // Update bird
            bird.velocity += bird.gravity;
            bird.y += bird.velocity;

            // Bird boundaries
            if (bird.y + bird.size / 2 > ground.y) { // Adjusted for feet
                bird.y = ground.y - bird.size / 2;
                gameOver = true;
            }
            if (bird.y < 0) {
                bird.y = 0;
                gameOver = true;
            }

            // Update pipes
            pipes.forEach((pipe, index) => {
                pipe.x -= pipeSpeed;

                // Remove off-screen pipes
                if (pipe.x + pipeWidth < 0) {
                    pipes.splice(index, 1);
                }

                // Score when bird passes pipe
                if (!pipe.passed && pipe.x + pipeWidth < bird.x) {
                    score++;
                    pipe.passed = true;
                }

                // Collision detection (using bird's bounding box)
                const birdRect = { x: bird.x - bird.size / 2, y: bird.y - bird.size / 2, w: bird.size, h: bird.size };
                const topPipeRect = { x: pipe.x, y: 0, w: pipeWidth, h: pipe.top };
                const bottomPipeRect = { x: pipe.x, y: canvas.height - ground.height - pipe.bottom, w: pipeWidth, h: pipe.bottom };

                if (checkCollision(birdRect, topPipeRect) || checkCollision(birdRect, bottomPipeRect)) {
                    gameOver = true;
                }
            });

            // Generate new pipe
            if (frame % pipeInterval === 0) {
                generatePipe();
            }

            // Update ground (scrolling effect)
            ground.x -= ground.speed;
            if (ground.x <= -canvas.width) ground.x = 0;

            frame++;
        }

        function checkCollision(a, b) {
            return a.x < b.x + b.w && a.x + a.w > b.x && a.y < b.y + b.h && a.y + a.h > b.y;
        }

        function draw() {
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw background
            ctx.fillStyle = '#70c5ce';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw bird with wing flap animation (switch every 10 frames)
            const birdImage = (frame % 20 < 10) ? birdImageUp : birdImageDown;
            ctx.drawImage(birdImage, bird.x - bird.size / 2, bird.y - bird.size / 2, bird.size, bird.size);

            // Draw pipes
            ctx.fillStyle = '#228b22';
            pipes.forEach(pipe => {
                // Top pipe
                ctx.fillRect(pipe.x, 0, pipeWidth, pipe.top);
                // Bottom pipe
                ctx.fillRect(pipe.x, canvas.height - ground.height - pipe.bottom, pipeWidth, pipe.bottom);
            });

            // Draw ground (two parts for scrolling)
            ctx.fillStyle = '#8b4513';
            ctx.fillRect(ground.x, ground.y, canvas.width, ground.height);
            ctx.fillRect(ground.x + canvas.width, ground.y, canvas.width, ground.height);

            // Draw score
            ctx.fillStyle = '#fff';
            ctx.font = '30px Arial';
            ctx.fillText(`Score: ${score}`, 10, 50);

            // Game over or start screen
            if (gameOver) {
                ctx.fillStyle = '#000';
                ctx.font = '40px Arial';
                ctx.fillText('Game Over', 70, 250);
                ctx.font = '20px Arial';
                ctx.fillText('Click or Space to Start', 80, 300);
            }
        }

        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        // Start the game loop
        gameLoop();
    </script>
</body>

</html>
